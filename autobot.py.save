import os
import paramiko
import boto3
import vastai
import re

# AWS and Vast.ai setup (fill in credentials if needed)
aws_region = "us-east-1"
ec2 = boto3.client("ec2", region_name=aws_region)


# Function to interpret plain English commands
def execute_command(command):
    if "start an aws server" in command:
        print("Starting an AWS server...")
        ec2.run_instances(ImageId="ami-12345678", InstanceType="t2.micro", MinCount=1, MaxCount=1)

    elif "start a vast server" in command:
        gpu_match = re.search(r'with a (\d+)', command)
        gpu_type = gpu_match.group(1) if gpu_match else "3090"
        print(f"Starting a Vast.ai server with {gpu_type} GPU...")
        # Vast.ai API integration (example)
        vastai.create_instance(gpu=gpu_type)

    elif "make a chatbot script" in command:
        print("Creating chatbot script...")
        with open("chatbot.py", "w") as f:
            f.write('print("Hello, I am your chatbot!")')

    elif "send this script to aws" in command:
        print("Sending script to AWS server...")
        ssh = paramiko.SSHClient()
        ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
        ssh.connect("your-aws-instance-ip", username="ubuntu", key_filename="your-key.pem")
        os.system("scp chatbot.py ubuntu@your-aws-instance-ip:/home/ubuntu/")

    elif "run the script on aws" in command:
        print("Running script on AWS...")
        ssh = paramiko.SSHClient()
        ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
        ssh.connect("your-aws-instance-ip", username="ubuntu", key_filename="your-key.pem")
        ssh.exec_command("python3 /home/ubuntu/chatbot.py")

    else:
        print("Command not recognized.")


# Example Usage
command = input("Enter command: ")
execute_command(command)
